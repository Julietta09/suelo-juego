<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üå± Procesos pedogen√©ticos ‚Äî Cuestionario</title>
  <style>
    :root{
      --bg:#ffffff;          
      --text:#0f172a;        
      --muted:#64748b;       
      --card:#ffffff;
      --border:#e2e8f0;      
      --accent:#86efac;      
      --accent-strong:#22c55e; 
      --ok:#16a34a;          
      --bad:#ef4444;         
    }
    *{ box-sizing:border-box }
    body{
      margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: var(--bg); color: var(--text);
    }
    header{
      padding: 28px 20px; text-align:center; border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(134,239,172,.20), rgba(134,239,172,.03));
    }
    header h1{ margin:.2rem 0; font-size: clamp(1.4rem, 3.2vw, 2.2rem); }
    header p{ margin:0; color:var(--muted) }

    .app{ max-width: 1100px; margin: 0 auto; padding: 18px; }
    .topbar{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; margin-bottom:12px; }
    .badge{
      display:inline-flex; gap:8px; align-items:center; padding:8px 12px; border-radius:999px;
      background: #f0fdf4; border:1px solid #bbf7d0; color:#14532d; font-size:.9rem;
    }
    .btn{
      background:#f8fafc; border:1px solid var(--border); color:var(--text); border-radius:10px;
      padding:10px 14px; cursor:pointer;
    }
    .btn.primary{ background: #22c55e; color:white; border-color:#22c55e }
    .btn.accent{ background:#86efac; border-color:#86efac; color:#065f46 }
    .btn:disabled{ opacity:.6; cursor:not-allowed }

    .card{
      background:var(--card); border:1px solid var(--border); border-radius:16px; padding:16px;
      box-shadow: 0 4px 14px rgba(2,6,23,.04);
    }
    .grid{ display:grid; grid-template-columns: 1fr; gap:16px; }
    @media (min-width: 900px){ .grid{ grid-template-columns: 1.25fr .75fr; } }

    h2.case{ margin:.2rem 0 .6rem 0; font-size:1.05rem }
    .question{ font-weight:600; line-height:1.55; }
    .section-title{ margin:.8rem 0 .4rem; font-size:.95rem; color:#065f46 }
    .choices{ display:grid; grid-template-columns: 1fr; gap:8px; }
    .choice{
      background:#ffffff; border:1px solid var(--border); border-radius:12px; padding:12px; text-align:left;
      cursor:pointer; transition: box-shadow .15s ease, transform .03s ease, border-color .15s ease;
    }
    .choice:hover{ transform: translateY(-1px); box-shadow: 0 6px 18px rgba(2,6,23,.06) }
    .choice.selected{ outline: 2px solid var(--accent); border-color:#86efac; background:#f0fdf4 }
    .choice.correct{ border-color: var(--ok); box-shadow: 0 0 0 2px rgba(22,163,74,.25) inset; }
    .choice.wrong{ border-color: var(--bad); box-shadow: 0 0 0 2px rgba(239,68,68,.18) inset; }

    .side .card + .card{ margin-top:12px }
    .muted{ color:var(--muted) }
    .hidden{ display:none }
    .footer{ text-align:center; color:var(--muted); padding:14px }
    .feedback h3{ margin:.2rem 0 .4rem 0; font-size:1rem }
    .kpi{ display:flex; gap:8px; flex-wrap:wrap }
    .pill{ background:#ecfeff; border:1px solid #bae6fd; color:#075985; padding:4px 8px; border-radius:999px; font-size:.8rem }
  </style>
</head>
<body>
<header>
  <h1>üå± üë∑ T√©cnico de Suelos ‚Äî Juego</h1>
  <p>Selecciona el <strong>subproceso</strong> y la <strong>acci√≥n</strong> correctos para cada pregunta.</p>
</header>

<div class="app">
  <div class="topbar">
    <div class="kpi">
      <span class="badge">üéØ Pregunta <span id="caseIndex">1</span>/<span id="caseTotal">‚Äî</span></span>
      <span class="badge">‚≠ê Puntaje: <span id="score">0</span></span>
      <span class="badge">‚è±Ô∏è <span id="timer">00:00</span></span>
    </div>
    <div>
      <button id="btnReiniciar" class="btn">Reiniciar</button>
      <button id="btnSaltar" class="btn">Saltar</button>
    </div>
  </div>

  <div class="grid">
    <!-- Lado principal -->
    <section class="card">
      <h2 class="case">Caso</h2>
      <p id="caseText" class="question"></p>
      <!-- Aqu√≠ va la imagen si existe -->
      <div id="caseImage" style="margin:12px 0;"></div>

      <p class="section-title">1) Subproceso</p>
      <div id="processChoices" class="choices"></div>

      <p class="section-title">2) Acci√≥n recomendada</p>
      <div id="actionChoices" class="choices"></div>

      <div style="margin-top:12px; display:flex; gap:8px; justify-content:flex-end;">
        <button id="btnComprobar" class="btn primary">Comprobar</button>
        <button id="btnSiguiente" class="btn accent hidden">Siguiente ‚ñ∂</button>
      </div>
    </section>

    <!-- Lado derecho -->
    <aside class="side">
      <div class="card feedback" id="feedbackBox">
        <h3>Retroalimentaci√≥n</h3>
        <p class="muted">Elige el subproceso y la acci√≥n. Luego presiona <em>Comprobar</em> para ver si acertaste.</p>
      </div>

      <div class="card">
        <h3 style="margin:.2rem 0 .6rem 0;">Gu√≠a r√°pida</h3>
        <p class="muted" style="margin:0">üìå Recuerda:</strong>
  <ul style="margin:8px 0 0 18px;padding:0;">
    <li><strong>Adiciones</strong> ‚Üí materiales que llegan.</li>
    <li><strong>Transformaciones</strong> ‚Üí cambios internos.</li>
    <li><strong>Translocaciones</strong> ‚Üí movimiento dentro del perfil.</li>
    <li><strong>P√©rdidas</strong> ‚Üí salida de materiales.</li>
  </ul>
</p>
      </div>
    </aside>
  </div>

  <section id="summaryPanel" class="card hidden" style="margin-top:14px;">
    <h2>Resumen</h2>
    <p id="summaryText"></p>
    <div style="display:flex; gap:8px;">
      <button class="btn" id="btnReview">Revisar respuestas</button>
      <button class="btn accent" id="btnPlayAgain">Jugar de nuevo</button>
    </div>
  </section>

  <p class="footer">Calidad del suelo.</p>
</div>

<script>
(function(){
  // === Casos ===
  const CASES = [
    {
      q: "1) ¬øQu√© proceso ocurre cuando un r√≠o deposita sedimentos finos en una zona aluvial, y c√≥mo se maneja?",
      processAnswer: "Cumulizaci√≥n por acreci√≥n de part√≠culas minerales.",
      actionAnswer: "manejo de sedimentos",
      hint: "Dep√≥sito peri√≥dico de sedimentos aluviales."
    },
    {
      q: "2) ¬øQu√© indica la acumulaci√≥n de hojarasca superficial en un bosque denso, y qu√© acci√≥n favorece este proceso?",
      processAnswer: "Littering por acumulaci√≥n de materia org√°nica fresca.",
      actionAnswer: "conservar cobertura",
      hint: "Formaci√≥n de horizonte O por aporte org√°nico."
    },
    {
      q: "3) ¬øQu√© proceso est√° en juego cuando las lluvias intensas en una ladera provocan p√©rdida de la capa superficial oscura?",
      processAnswer: "Erosi√≥n pluvial.",
      actionAnswer: "control de erosi√≥n",
      hint: "Remoci√≥n por agua de lluvia."
    },
    {
      q: "4) ¬øQu√© ocurre en climas muy h√∫medos cuando se pierden bases por lavado profundo del perfil?",
      processAnswer: "Lixiviaci√≥n de bases.",
      actionAnswer: "manejo de cal y pH",
      hint: "Salida de Ca, Mg, K por exceso de percolaci√≥n."
    },
    {
      q: "5) ¬øQu√© indica la presencia de un horizonte E claro seguido de uno de acumulaci√≥n, y c√≥mo se mejora la estructura?",
      processAnswer: "Eluviaci√≥n e iluviaci√≥n de coloides.",
      actionAnswer: "mejorar estructura",
      hint: "Salida y entrada de arcillas/humus.",
      img: "imagenes/5.png"
    },
    {
      q: "6) ¬øQu√© proceso se observa cuando hay costras blancas en suelos secos con riego superficial continuo?",
      processAnswer: "Salinizaci√≥n.",
      actionAnswer: "lixiviado de sales",
      hint: "Acumulaci√≥n de sales solubles."
    },
    {
      q: "7) ¬øQu√© significa la efervescencia con HCl en un horizonte seco, y qu√© acci√≥n se recomienda?",
      processAnswer: "Calcificaci√≥n por acumulaci√≥n de carbonatos.",
      actionAnswer: "romper costra y mejorar drenaje",
      hint: "Horizonte c√°lcico/petroc√°lcico."
    },
    {
      q: "8) ¬øQu√© proceso ocurre cuando se remueven materiales org√°nicos oscuros, dejando un horizonte claro?",
      processAnswer: "Leucinizaci√≥n.",
      actionAnswer: "incrementar materia org√°nica",
      hint: "P√©rdida/movimiento de compuestos oscuros."
    },
    {
      q: "9) ¬øQu√© indica la mezcla interna de materiales en suelos con arcillas expansivas y grietas?",
      processAnswer: "Argiloturbaci√≥n (edafoturbaci√≥n).",
      actionAnswer: "manejo de humedad en Vertisoles",
      hint: "Vertisoles con grietas estacionales."
    },
    {
      q: "10) ¬øQu√© proceso oscurece el horizonte A por actividad biol√≥gica intensa y recubrimiento de agregados?",
      processAnswer: "Melanizaci√≥n.",
      actionAnswer: "mantener aportes org√°nicos",
      hint: "Estabilizaci√≥n de humus en agregados.",
      img:"imagenes/10.png"
    },
    {
      q: "11) ¬øQu√© ocurre en ambientes muy h√∫medos y c√°lidos con remoci√≥n de s√≠lice y acumulaci√≥n de sesqui√≥xidos?",
      processAnswer: "Desilicaci√≥n y ferralitizaci√≥n.",
      actionAnswer: "mejorar drenaje y cobertura",
      hint: "Dominio de Fe/Al; bajos silicatos."
    },
    {
      q: "12) ¬øQu√© indica la presencia de colores grises/moteados en suelos h√∫medos con ra√≠ces mal aireadas?",
      processAnswer: "Gleizaci√≥n por condiciones reductoras.",
      actionAnswer: "drenaje",
      hint: "Reducci√≥n de Fe; colores gley."
    },
    {
      q: "13) ¬øQu√© proceso transforma el color del horizonte B en tonos pardo a rojo en suelos bien drenados y c√°lidos?",
      processAnswer: "Rubefacci√≥n/marronizaci√≥n por √≥xidos de Fe.",
      actionAnswer: "manejo de fertilidad",
      hint: "Deshidrataci√≥n de sesqui√≥xidos.",
      img: "imagenes/13.png"
    },
    {
      q: "14) ¬øQu√© ocurre cuando la maquinaria compacta el suelo, reduciendo poros e infiltraci√≥n?",
      processAnswer: "Endurecimiento por compactaci√≥n.",
      actionAnswer: "descompactar",
      hint: "Subsolado/tr√°fico controlado."
    }
  ];

  // === Banco de opciones ===
  const PROCESS_POOL = CASES.map(c=>c.processAnswer);
  const ACTIONS = {
    "manejo de sedimentos": "manejo de sedimentos",
    "conservar cobertura": "conservar cobertura",
    "control de erosi√≥n": "control de erosi√≥n",
    "manejo de cal y pH": "manejo de cal y pH",
    "mejorar estructura": "mejorar estructura",
    "lixiviado de sales": "lixiviado de sales",
    "romper costra y mejorar drenaje": "romper costra y mejorar drenaje",
    "incrementar materia org√°nica": "incrementar materia org√°nica",
    "manejo de humedad en Vertisoles": "manejo de humedad en Vertisoles",
    "mantener aportes org√°nicos": "mantener aportes org√°nicos",
    "mejorar drenaje y cobertura": "mejorar drenaje y cobertura",
    "drenaje": "drenaje",
    "manejo de fertilidad": "manejo de fertilidad",
    "descompactar": "descompactar"
  };
  const ACTION_POOL = Object.keys(ACTIONS);

  // === Estado ===
  let order = shuffle([...Array(CASES.length).keys()]);
  let idx = 0, score = 0;
  let selProcess = null, selAction = null;

  const caseText = document.getElementById("caseText");
  const caseImage = document.getElementById("caseImage");
  const caseIndex = document.getElementById("caseIndex");
  const caseTotal = document.getElementById("caseTotal");
  const scoreEl = document.getElementById("score");
  const processChoices = document.getElementById("processChoices");
  const actionChoices = document.getElementById("actionChoices");
  const feedbackBox = document.getElementById("feedbackBox");
  const btnComprobar = document.getElementById("btnComprobar");
  const btnSiguiente = document.getElementById("btnSiguiente");
  const btnReiniciar = document.getElementById("btnReiniciar");
  const btnSaltar = document.getElementById("btnSaltar");
  const summaryPanel = document.getElementById("summaryPanel");
  const summaryText = document.getElementById("summaryText");
  const btnReview = document.getElementById("btnReview");
  const btnPlayAgain = document.getElementById("btnPlayAgain");

  caseTotal.textContent = CASES.length;

  // Timer
  let start = Date.now();
  setInterval(()=>{
    const t = Math.floor((Date.now()-start)/1000);
    const m = String(Math.floor(t/60)).padStart(2,'0');
    const s = String(t%60).padStart(2,'0');
    document.getElementById("timer").textContent = `${m}:${s}`;
  },1000);

  function renderCase(){
    const c = CASES[order[idx]];
    caseIndex.textContent = idx+1;
    caseText.textContent = c.q;
    selProcess = null; selAction = null;
    feedbackBox.innerHTML = `<h3>Retroalimentaci√≥n</h3><p class="muted">Selecciona el <strong>subproceso</strong> y la <strong>acci√≥n</strong>. Pista: ${c.hint}</p>`;
    btnSiguiente.classList.add("hidden");

    // Imagen si existe
    if (c.img) {
      caseImage.innerHTML = `<img src="${c.img}" alt="ilustraci√≥n" style="max-width:100%; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,.08)">`;
    } else {
      caseImage.innerHTML = "";
    }

    // Procesos
    const pSet = pickWithCorrect(PROCESS_POOL, c.processAnswer, 4);
    processChoices.innerHTML = "";
    pSet.forEach(txt=>{
      const b = document.createElement("button");
      b.className = "choice"; b.type = "button"; b.textContent = txt;
      b.onclick = ()=>{
        selProcess = txt;
        [...processChoices.children].forEach(ch=>ch.classList.remove("selected"));
        b.classList.add("selected");
      };
      processChoices.appendChild(b);
    });

    // Acciones
    const aSet = pickWithCorrect(ACTION_POOL, c.actionAnswer, 4);
    actionChoices.innerHTML = "";
    aSet.forEach(key=>{
      const b = document.createElement("button");
      b.className = "choice"; b.type = "button"; b.textContent = ACTIONS[key];
      b.onclick = ()=>{
        selAction = key;
        [...actionChoices.children].forEach(ch=>ch.classList.remove("selected"));
        b.classList.add("selected");
      };
      actionChoices.appendChild(b);
    });
  }

  function comprobar(){
    const c = CASES[order[idx]];
    if(!selProcess || !selAction){
      feedbackBox.innerHTML = `<h3>‚õî Falta seleccionar</h3><p class="muted">Debes elegir el subproceso y la acci√≥n.</p>`;
      return;
    }
    const procOK = selProcess === c.processAnswer;
    const actOK  = selAction === c.actionAnswer;

    [...processChoices.children].forEach(ch=>{
      if(ch.textContent === c.processAnswer) ch.classList.add("correct");
      if(ch.classList.contains("selected") && !procOK) ch.classList.add("wrong");
    });
    [...actionChoices.children].forEach(ch=>{
      if(ch.textContent === ACTIONS[c.actionAnswer]) ch.classList.add("correct");
      if(ch.classList.contains("selected") && !actOK) ch.classList.add("wrong");
    });

    let delta = 0; if(procOK) delta += 5; if(actOK) delta += 5;
    score += delta; scoreEl.textContent = score;

    const icon = (procOK && actOK) ? "‚úÖ" : (procOK || actOK) ? "‚öñÔ∏è" : "‚ùå";
    feedbackBox.innerHTML = `<h3>${icon} Explicaci√≥n</h3>
      <p><strong>Subproceso correcto:</strong> ${c.processAnswer}</p>
      <p><strong>Acci√≥n recomendada:</strong> ${ACTIONS[c.actionAnswer]}</p>
      <p class="muted">Pista del caso: ${c.hint}</p>
      <p><small>+${delta} puntos</small></p>`;
    btnSiguiente.classList.remove("hidden");
  }

  function siguiente(){
    if(idx < order.length-1){ idx++; renderCase(); }
    else { finalizar(); }
  }

  function finalizar(){
    document.querySelector(".grid").classList.add("hidden");
    summaryPanel.classList.remove("hidden");
    const max = CASES.length * 10;
    summaryText.textContent = `üéâ Puntaje final: ${score}/${max}.`;
  }

  function reiniciar(){
    score = 0; scoreEl.textContent = 0; idx = 0;
    order = shuffle([...Array(CASES.length).keys()]);
    document.querySelector(".grid").classList.remove("hidden");
    summaryPanel.classList.add("hidden");
    renderCase();
  }

  function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr; }
  function pickWithCorrect(pool, correct, n){
    const set = new Set([correct]);
    while(set.size < n){
      const r = pool[Math.floor(Math.random()*pool.length)];
      set.add(r);
    }
    return shuffle([...set]);
  }

  // Eventos
  btnComprobar.onclick = comprobar;
  btnSiguiente.onclick = siguiente;
  btnReiniciar.onclick = reiniciar;
  btnSaltar.onclick = siguiente;
  btnReview.onclick = ()=>alert("Consejo: repasa los casos en que fallaste el subproceso o la acci√≥n.");
  btnPlayAgain.onclick = reiniciar;

  renderCase();
})();
</script>
</body>
</html>

